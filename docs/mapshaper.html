<!DOCTYPE html>
<html lang="en" xml:lang="en">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Edit and Join with Mapshaper | Hands-On Data Visualization</title>
  <meta name="description" content="Tell your story and show it with data, using free and easy-to-learn tools on the web. This introductory book teaches you how to design interactive charts and customized maps for your website, beginning with easy drag-and-drop tools, such as Google Sheets, Datawrapper, and Tableau Public. You will also gradually learn how to edit open-source code templates built with Chart.js, Highcharts, and Leaflet on GitHub. Follow along with the step-by-step tutorials, real-world examples, and online resources. This book is ideal for students, non-profit organizations, small business owners, local governments, journalists, academics, or anyone who wants to tell their story and show the data. No coding experience is required." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Edit and Join with Mapshaper | Hands-On Data Visualization" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://handsondataviz.github.io/" />
  <meta property="og:image" content="http://handsondataviz.github.io//images/cover-400wide.jpg" />
  <meta property="og:description" content="Tell your story and show it with data, using free and easy-to-learn tools on the web. This introductory book teaches you how to design interactive charts and customized maps for your website, beginning with easy drag-and-drop tools, such as Google Sheets, Datawrapper, and Tableau Public. You will also gradually learn how to edit open-source code templates built with Chart.js, Highcharts, and Leaflet on GitHub. Follow along with the step-by-step tutorials, real-world examples, and online resources. This book is ideal for students, non-profit organizations, small business owners, local governments, journalists, academics, or anyone who wants to tell their story and show the data. No coding experience is required." />
  <meta name="github-repo" content="handsondataviz/book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Edit and Join with Mapshaper | Hands-On Data Visualization" />
  <meta name="twitter:site" content="@handsondataviz" />
  <meta name="twitter:description" content="Tell your story and show it with data, using free and easy-to-learn tools on the web. This introductory book teaches you how to design interactive charts and customized maps for your website, beginning with easy drag-and-drop tools, such as Google Sheets, Datawrapper, and Tableau Public. You will also gradually learn how to edit open-source code templates built with Chart.js, Highcharts, and Leaflet on GitHub. Follow along with the step-by-step tutorials, real-world examples, and online resources. This book is ideal for students, non-profit organizations, small business owners, local governments, journalists, academics, or anyone who wants to tell their story and show the data. No coding experience is required." />
  <meta name="twitter:image" content="http://handsondataviz.github.io//images/cover-400wide.jpg" />

<meta name="author" content="Jack Dougherty" />
<meta name="author" content="Ilya Ilyankou" />


<meta name="date" content="2021-04-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/favicon.png" type="image/x-icon" />
<link rel="prev" href="geojsonio.html"/>
<link rel="next" href="convert-kmz.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-5488840-29"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-5488840-29');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><strong>Hands-On Data Visualization</strong><br>by Jack Dougherty & Ilya Ilyankou</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="audience-overview.html"><a href="audience-overview.html"><i class="fa fa-check"></i>Audience and Overview</a></li>
<li class="chapter" data-level="" data-path="authors.html"><a href="authors.html"><i class="fa fa-check"></i>Authors &amp; Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="open-access.html"><a href="open-access.html"><i class="fa fa-check"></i>About Open-Access Web Edition</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction: Why Data Visualization?</a>
<ul>
<li class="chapter" data-level="" data-path="believe.html"><a href="believe.html"><i class="fa fa-check"></i>What Can You Believe?</a></li>
<li class="chapter" data-level="" data-path="persuasive.html"><a href="persuasive.html"><i class="fa fa-check"></i>Some Pictures Are More Persuasive</a></li>
<li class="chapter" data-level="" data-path="shades.html"><a href="shades.html"><i class="fa fa-check"></i>Different Shades of the Truth</a></li>
<li class="chapter" data-level="" data-path="organization.html"><a href="organization.html"><i class="fa fa-check"></i>Organization of the Book</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="choose.html"><a href="choose.html"><i class="fa fa-check"></i><b>1</b> Choose Tools to Tell Your Story</a>
<ul>
<li class="chapter" data-level="" data-path="sketch.html"><a href="sketch.html"><i class="fa fa-check"></i>Start Sketching Your Data Story</a></li>
<li class="chapter" data-level="" data-path="tool-factors.html"><a href="tool-factors.html"><i class="fa fa-check"></i>Ten Factors When Considering Tools</a></li>
<li class="chapter" data-level="" data-path="recommended-tools.html"><a href="recommended-tools.html"><i class="fa fa-check"></i>Our Recommended Tools</a></li>
<li class="chapter" data-level="" data-path="password-manager.html"><a href="password-manager.html"><i class="fa fa-check"></i>Use a Password Manager</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="spreadsheet.html"><a href="spreadsheet.html"><i class="fa fa-check"></i><b>2</b> Strengthen Your Spreadsheet Skills</a>
<ul>
<li class="chapter" data-level="" data-path="spreadsheet-tools.html"><a href="spreadsheet-tools.html"><i class="fa fa-check"></i>Select your Spreadsheet Tools</a></li>
<li class="chapter" data-level="" data-path="csv.html"><a href="csv.html"><i class="fa fa-check"></i>Download to CSV or ODS Format</a></li>
<li class="chapter" data-level="" data-path="copy.html"><a href="copy.html"><i class="fa fa-check"></i>Make a Copy of a Google Sheet</a></li>
<li class="chapter" data-level="" data-path="share.html"><a href="share.html"><i class="fa fa-check"></i>Share Your Google Sheets</a></li>
<li class="chapter" data-level="" data-path="upload.html"><a href="upload.html"><i class="fa fa-check"></i>Upload and Convert to Google Sheets</a></li>
<li class="chapter" data-level="" data-path="geocode.html"><a href="geocode.html"><i class="fa fa-check"></i>Geocode Addresses in Google Sheets</a></li>
<li class="chapter" data-level="" data-path="forms.html"><a href="forms.html"><i class="fa fa-check"></i>Collect Data with Google Forms</a></li>
<li class="chapter" data-level="" data-path="sort.html"><a href="sort.html"><i class="fa fa-check"></i>Sort and Filter Data</a></li>
<li class="chapter" data-level="" data-path="calculate.html"><a href="calculate.html"><i class="fa fa-check"></i>Calculate with Formulas</a></li>
<li class="chapter" data-level="" data-path="pivot.html"><a href="pivot.html"><i class="fa fa-check"></i>Summarize Data with Pivot Tables</a></li>
<li class="chapter" data-level="" data-path="vlookup.html"><a href="vlookup.html"><i class="fa fa-check"></i>Match Columns with VLOOKUP</a></li>
<li class="chapter" data-level="" data-path="database.html"><a href="database.html"><i class="fa fa-check"></i>Spreadsheet vs. Relational Database</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="find.html"><a href="find.html"><i class="fa fa-check"></i><b>3</b> Find and Question Your Data</a>
<ul>
<li class="chapter" data-level="" data-path="guiding.html"><a href="guiding.html"><i class="fa fa-check"></i>Guiding Questions for Your Search</a></li>
<li class="chapter" data-level="" data-path="public.html"><a href="public.html"><i class="fa fa-check"></i>Public and Private Data</a></li>
<li class="chapter" data-level="" data-path="mask-aggregate.html"><a href="mask-aggregate.html"><i class="fa fa-check"></i>Mask or Aggregate Sensitive Data</a></li>
<li class="chapter" data-level="" data-path="opendata.html"><a href="opendata.html"><i class="fa fa-check"></i>Open Data Repositories</a></li>
<li class="chapter" data-level="" data-path="source.html"><a href="source.html"><i class="fa fa-check"></i>Source Your Data</a></li>
<li class="chapter" data-level="" data-path="bad-data.html"><a href="bad-data.html"><i class="fa fa-check"></i>Recognize Bad Data</a></li>
<li class="chapter" data-level="" data-path="question.html"><a href="question.html"><i class="fa fa-check"></i>Question Your Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="clean.html"><a href="clean.html"><i class="fa fa-check"></i><b>4</b> Clean Up Messy Data</a>
<ul>
<li class="chapter" data-level="" data-path="smart-cleanup.html"><a href="smart-cleanup.html"><i class="fa fa-check"></i>Smart Cleanup with Google Sheets</a></li>
<li class="chapter" data-level="" data-path="find-and-replace.html"><a href="find-and-replace.html"><i class="fa fa-check"></i>Find and Replace with Blank</a></li>
<li class="chapter" data-level="" data-path="transpose.html"><a href="transpose.html"><i class="fa fa-check"></i>Transpose Rows and Columns</a></li>
<li class="chapter" data-level="" data-path="split-data.html"><a href="split-data.html"><i class="fa fa-check"></i>Split Data into Separate Columns</a></li>
<li class="chapter" data-level="" data-path="combine-data.html"><a href="combine-data.html"><i class="fa fa-check"></i>Combine Data into One Column</a></li>
<li class="chapter" data-level="" data-path="tabula.html"><a href="tabula.html"><i class="fa fa-check"></i>Extract Tables from PDFs with Tabula</a></li>
<li class="chapter" data-level="" data-path="open-refine.html"><a href="open-refine.html"><i class="fa fa-check"></i>Clean Data with OpenRefine</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="comparisons.html"><a href="comparisons.html"><i class="fa fa-check"></i><b>5</b> Make Meaningful Comparisons</a>
<ul>
<li class="chapter" data-level="" data-path="describe-comparisons.html"><a href="describe-comparisons.html"><i class="fa fa-check"></i>Precisely Describe Comparisons</a></li>
<li class="chapter" data-level="" data-path="normalize.html"><a href="normalize.html"><i class="fa fa-check"></i>Normalize Your Data</a></li>
<li class="chapter" data-level="" data-path="biased-comparisons.html"><a href="biased-comparisons.html"><i class="fa fa-check"></i>Beware of Biased Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chart.html"><a href="chart.html"><i class="fa fa-check"></i><b>6</b> Chart Your Data</a>
<ul>
<li class="chapter" data-level="" data-path="chart-design.html"><a href="chart-design.html"><i class="fa fa-check"></i>Chart Design Principles</a></li>
<li class="chapter" data-level="" data-path="chart-google.html"><a href="chart-google.html"><i class="fa fa-check"></i>Google Sheets Charts</a></li>
<li class="chapter" data-level="" data-path="bar-column-google.html"><a href="bar-column-google.html"><i class="fa fa-check"></i>- Bar and Column Charts</a></li>
<li class="chapter" data-level="" data-path="histogram-google.html"><a href="histogram-google.html"><i class="fa fa-check"></i>- Histograms</a></li>
<li class="chapter" data-level="" data-path="pie-line-area-google.html"><a href="pie-line-area-google.html"><i class="fa fa-check"></i>- Pie, Line, and Area Charts</a></li>
<li class="chapter" data-level="" data-path="chart-datawrapper.html"><a href="chart-datawrapper.html"><i class="fa fa-check"></i>Datawrapper Charts</a></li>
<li class="chapter" data-level="" data-path="annotated-datawrapper.html"><a href="annotated-datawrapper.html"><i class="fa fa-check"></i>- Annotated Charts</a></li>
<li class="chapter" data-level="" data-path="range-datawrapper.html"><a href="range-datawrapper.html"><i class="fa fa-check"></i>- Range Charts</a></li>
<li class="chapter" data-level="" data-path="scatter-bubble-datawrapper.html"><a href="scatter-bubble-datawrapper.html"><i class="fa fa-check"></i>- Scatter and Bubble Charts</a></li>
<li class="chapter" data-level="" data-path="chart-tableau.html"><a href="chart-tableau.html"><i class="fa fa-check"></i>Tableau Public Charts</a></li>
<li class="chapter" data-level="" data-path="scatter-tableau.html"><a href="scatter-tableau.html"><i class="fa fa-check"></i>- Scatter Chart</a></li>
<li class="chapter" data-level="" data-path="filtered-line-tableau.html"><a href="filtered-line-tableau.html"><i class="fa fa-check"></i>- Filtered Line Chart</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="map.html"><a href="map.html"><i class="fa fa-check"></i><b>7</b> Map Your Data</a>
<ul>
<li class="chapter" data-level="" data-path="map-design.html"><a href="map-design.html"><i class="fa fa-check"></i>Map Design Principles</a></li>
<li class="chapter" data-level="" data-path="design-choropleth.html"><a href="design-choropleth.html"><i class="fa fa-check"></i>Design Choropleth Colors &amp; Intervals</a></li>
<li class="chapter" data-level="" data-path="normalize-choropleth.html"><a href="normalize-choropleth.html"><i class="fa fa-check"></i>Normalize Choropleth Map Data</a></li>
<li class="chapter" data-level="" data-path="mymaps.html"><a href="mymaps.html"><i class="fa fa-check"></i>Point Map with Google My Maps</a></li>
<li class="chapter" data-level="" data-path="symbolmap-datawrapper.html"><a href="symbolmap-datawrapper.html"><i class="fa fa-check"></i>Symbol Point Map with Datawrapper</a></li>
<li class="chapter" data-level="" data-path="choropleth-datawrapper.html"><a href="choropleth-datawrapper.html"><i class="fa fa-check"></i>Choropleth Map with Datawrapper</a></li>
<li class="chapter" data-level="" data-path="map-tableau.html"><a href="map-tableau.html"><i class="fa fa-check"></i>Choropleth Map with Tableau Public</a></li>
<li class="chapter" data-level="" data-path="map-socrata.html"><a href="map-socrata.html"><i class="fa fa-check"></i>Current Map with Socrata Open Data</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="table.html"><a href="table.html"><i class="fa fa-check"></i><b>8</b> Table Your Data</a>
<ul>
<li class="chapter" data-level="" data-path="table-design.html"><a href="table-design.html"><i class="fa fa-check"></i>Table Design Principles</a></li>
<li class="chapter" data-level="" data-path="table-datawrapper.html"><a href="table-datawrapper.html"><i class="fa fa-check"></i>Datawrapper Table with Sparklines</a></li>
<li class="chapter" data-level="" data-path="other-table-tools.html"><a href="other-table-tools.html"><i class="fa fa-check"></i>Other Table-Making Tools</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="embed.html"><a href="embed.html"><i class="fa fa-check"></i><b>9</b> Embed On the Web</a>
<ul>
<li class="chapter" data-level="" data-path="static.html"><a href="static.html"><i class="fa fa-check"></i>Static Image vs Interactive iframe</a></li>
<li class="chapter" data-level="" data-path="embed-code.html"><a href="embed-code.html"><i class="fa fa-check"></i>Get the Embed Code or iframe Tag</a></li>
<li class="chapter" data-level="" data-path="paste-code.html"><a href="paste-code.html"><i class="fa fa-check"></i>Paste Code or iframe to Website</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="github.html"><a href="github.html"><i class="fa fa-check"></i><b>10</b> Edit and Host Code with GitHub</a>
<ul>
<li class="chapter" data-level="" data-path="copy-leaflet.html"><a href="copy-leaflet.html"><i class="fa fa-check"></i>Copy, Edit, and Host a Simple Leaflet Map Template</a></li>
<li class="chapter" data-level="" data-path="gh-pages-link-to-iframe.html"><a href="gh-pages-link-to-iframe.html"><i class="fa fa-check"></i>Convert GitHub Pages Link to iframe</a></li>
<li class="chapter" data-level="" data-path="create-repo.html"><a href="create-repo.html"><i class="fa fa-check"></i>Create a New Repo and Upload Files on GitHub</a></li>
<li class="chapter" data-level="" data-path="github-desktop-atom.html"><a href="github-desktop-atom.html"><i class="fa fa-check"></i>GitHub Desktop and Atom Editor to Code Efficiently</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chartcode.html"><a href="chartcode.html"><i class="fa fa-check"></i><b>11</b> Chart.js and Highcharts Templates</a>
<ul>
<li class="chapter" data-level="" data-path="chartjs-bar-column.html"><a href="chartjs-bar-column.html"><i class="fa fa-check"></i>Bar or Column Chart with Chart.js</a></li>
<li class="chapter" data-level="" data-path="chartjs-error-bars.html"><a href="chartjs-error-bars.html"><i class="fa fa-check"></i>Error Bars with Chart.js</a></li>
<li class="chapter" data-level="" data-path="chartjs-line.html"><a href="chartjs-line.html"><i class="fa fa-check"></i>Line Chart with Chart.js</a></li>
<li class="chapter" data-level="" data-path="highcharts-annotated-line.html"><a href="highcharts-annotated-line.html"><i class="fa fa-check"></i>Annotated Line Chart with Highcharts</a></li>
<li class="chapter" data-level="" data-path="chartjs-scatter.html"><a href="chartjs-scatter.html"><i class="fa fa-check"></i>Scatter Chart with Chart.js</a></li>
<li class="chapter" data-level="" data-path="chartjs-bubble.html"><a href="chartjs-bubble.html"><i class="fa fa-check"></i>Bubble Chart with Chart.js</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="leaflet.html"><a href="leaflet.html"><i class="fa fa-check"></i><b>12</b> Leaflet Map Templates</a>
<ul>
<li class="chapter" data-level="" data-path="leaflet-maps-with-google-sheets.html"><a href="leaflet-maps-with-google-sheets.html"><i class="fa fa-check"></i>Leaflet Maps with Google Sheets</a></li>
<li class="chapter" data-level="" data-path="leaflet-storymaps-with-google-sheets.html"><a href="leaflet-storymaps-with-google-sheets.html"><i class="fa fa-check"></i>Leaflet Storymaps with Google Sheets</a></li>
<li class="chapter" data-level="" data-path="google-sheets-api-key.html"><a href="google-sheets-api-key.html"><i class="fa fa-check"></i>Get Your Google Sheets API Key</a></li>
<li class="chapter" data-level="" data-path="leaflet-maps-with-csv.html"><a href="leaflet-maps-with-csv.html"><i class="fa fa-check"></i>Leaflet Maps with CSV Data</a></li>
<li class="chapter" data-level="" data-path="leaflet-heatmap.html"><a href="leaflet-heatmap.html"><i class="fa fa-check"></i>Leaflet Heatmap Points with CSV Data</a></li>
<li class="chapter" data-level="" data-path="leaflet-searchable-map.html"><a href="leaflet-searchable-map.html"><i class="fa fa-check"></i>Leaflet Searchable Point Map</a></li>
<li class="chapter" data-level="" data-path="leaflet-maps-open-data-apis.html"><a href="leaflet-maps-open-data-apis.html"><i class="fa fa-check"></i>Leaflet Maps with Open Data APIs</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="transform.html"><a href="transform.html"><i class="fa fa-check"></i><b>13</b> Transform Your Map Data</a>
<ul>
<li class="chapter" data-level="" data-path="geojson.html"><a href="geojson.html"><i class="fa fa-check"></i>Geospatial Data and GeoJSON</a></li>
<li class="chapter" data-level="" data-path="find-geojson.html"><a href="find-geojson.html"><i class="fa fa-check"></i>Find GeoJSON Boundary Files</a></li>
<li class="chapter" data-level="" data-path="geojsonio.html"><a href="geojsonio.html"><i class="fa fa-check"></i>Draw and Edit with GeoJson.io</a></li>
<li class="chapter" data-level="" data-path="mapshaper.html"><a href="mapshaper.html"><i class="fa fa-check"></i>Edit and Join with Mapshaper</a></li>
<li class="chapter" data-level="" data-path="convert-kmz.html"><a href="convert-kmz.html"><i class="fa fa-check"></i>Convert Compressed KMZ to KML</a></li>
<li class="chapter" data-level="" data-path="mapwarper.html"><a href="mapwarper.html"><i class="fa fa-check"></i>Georeference with Map Warper</a></li>
<li class="chapter" data-level="" data-path="bulk-geocode.html"><a href="bulk-geocode.html"><i class="fa fa-check"></i>Bulk Geocode with US Census</a></li>
<li class="chapter" data-level="" data-path="pivot-point-to-polygon.html"><a href="pivot-point-to-polygon.html"><i class="fa fa-check"></i>Pivot Points into Polygon Data</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="detect.html"><a href="detect.html"><i class="fa fa-check"></i><b>14</b> Detect Lies and Reduce Bias</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-lie-with-charts.html"><a href="how-to-lie-with-charts.html"><i class="fa fa-check"></i>How to Lie with Charts</a></li>
<li class="chapter" data-level="" data-path="how-to-lie-with-maps.html"><a href="how-to-lie-with-maps.html"><i class="fa fa-check"></i>How to Lie with Maps</a></li>
<li class="chapter" data-level="" data-path="data-bias.html"><a href="data-bias.html"><i class="fa fa-check"></i>Recognize and Reduce Data Bias</a></li>
<li class="chapter" data-level="" data-path="spatial-bias.html"><a href="spatial-bias.html"><i class="fa fa-check"></i>Recognize and Reduce Spatial Bias</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="story.html"><a href="story.html"><i class="fa fa-check"></i><b>15</b> Tell and Show Your Data Story</a>
<ul>
<li class="chapter" data-level="" data-path="storyboard.html"><a href="storyboard.html"><i class="fa fa-check"></i>Build a Narrative on a Storyboard</a></li>
<li class="chapter" data-level="" data-path="draw-attention.html"><a href="draw-attention.html"><i class="fa fa-check"></i>Draw Attention to Meaning</a></li>
<li class="chapter" data-level="" data-path="sources-uncertainty.html"><a href="sources-uncertainty.html"><i class="fa fa-check"></i>Acknowledge Sources &amp; Uncertainty</a></li>
<li class="chapter" data-level="" data-path="story-format.html"><a href="story-format.html"><i class="fa fa-check"></i>Decide On Your Data Story Format</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="fix.html"><a href="fix.html"><i class="fa fa-check"></i><b>A</b> Fix Common Problems</a>
<ul>
<li class="chapter" data-level="A.1" data-path="fix-tool.html"><a href="fix-tool.html"><i class="fa fa-check"></i><b>A.1</b> Tool or platform problems</a></li>
<li class="chapter" data-level="A.2" data-path="fix-browser.html"><a href="fix-browser.html"><i class="fa fa-check"></i><b>A.2</b> Try a different browser</a></li>
<li class="chapter" data-level="A.3" data-path="fix-developer-tools.html"><a href="fix-developer-tools.html"><i class="fa fa-check"></i><b>A.3</b> Diagnose with developer tools</a></li>
<li class="chapter" data-level="A.4" data-path="fix-computer.html"><a href="fix-computer.html"><i class="fa fa-check"></i><b>A.4</b> Mac or Chromebook problems</a></li>
<li class="chapter" data-level="A.5" data-path="fix-data.html"><a href="fix-data.html"><i class="fa fa-check"></i><b>A.5</b> Watch out for bad data</a></li>
<li class="chapter" data-level="A.6" data-path="fix-iframe.html"><a href="fix-iframe.html"><i class="fa fa-check"></i><b>A.6</b> Common iframe errors</a></li>
<li class="chapter" data-level="A.7" data-path="fix-code.html"><a href="fix-code.html"><i class="fa fa-check"></i><b>A.7</b> Fix your code on GitHub</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="bookdown.html"><a href="bookdown.html"><i class="fa fa-check"></i><b>B</b> Publishing with Bookdown</a>
<ul>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i>Install and Set Up Bookdown</a></li>
<li class="chapter" data-level="" data-path="structure.html"><a href="structure.html"><i class="fa fa-check"></i>File Structure and Headers</a></li>
<li><a href="style-guide.html#style-guide">Style Guide for <em>Hands-On Data Visualization</em></a></li>
<li class="chapter" data-level="" data-path="images.html"><a href="images.html"><i class="fa fa-check"></i>Images and R Code-chunk Formatting</a></li>
<li class="chapter" data-level="" data-path="tables.html"><a href="tables.html"><i class="fa fa-check"></i>Tables in Markdown Format</a></li>
<li class="chapter" data-level="" data-path="zotero.html"><a href="zotero.html"><i class="fa fa-check"></i>Zotero and Better BibTeX for Notes and Biblio</a></li>
<li class="chapter" data-level="" data-path="alternative.html"><a href="alternative.html"><i class="fa fa-check"></i>Alternative Book Publishing Tools</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li style="padding: 10px 15px; font-weight: bold;">Open-access web edition</li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a></li>
<li><a href="https://bookdown.org" target="_blank">Built with Bookdown + RStudio</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Hands-On Data Visualization</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mapshaper" class="section level2 unnumbered">
<h2>Edit and Join with Mapshaper</h2>
<p>Like <a href="geojsonio.html">GeoJson.io</a>, <a href="https://mapshaper.org">Mapshaper</a>
is a free, open-source editor that can convert geospatial files, edit attribute
data, filter and dissolve features, simplify boundaries to make files smaller,
and many more. Mapshaper’s edit and join commands are much more powerful than the GeoJson.io tool. Unlike GeoJson.io, Mapshaper doesn’t have drawing tools, so you won’t be able to create geospatial files from scratch.</p>
<p>Mapshaper is developed and maintained by <a href="https://github.com/mbloch/mapshaper">Matthew Bloch on GitHub</a>.
This easy-to-learn web tool has replaced <em>many</em> of our map preparation
tasks that previously required expensive and hard-to-learn ArcGIS software, or its free
but still-challenging-to-learn cousin, QGIS. Even advanced GIS users may discover that Mapshaper
can be a quick alternative for some common but time-consuming tasks.</p>
<div id="import-convert-and-export-map-boundary-files" class="section level4 unnumbered">
<h4>Import, convert, and export map boundary files</h4>
<p>You can use Mapshaper to convert between geospatial file formats. Unlike GeoJson.io,
Mapshaper also allows you to upload Esri Shapefiles, so you can easily convert them into the web-friendly GeoJSON format.
In the following steps, we will convert a geospatial file by importing it to Mapshaper,
and then exporting it as a different file type.</p>
<ol style="list-style-type: decimal">
<li><p>Navigate to <a href="https://mapshaper.org">Mapshaper.org</a>. The start page is two large drag-and-drop zones
which you can use to import your file. The smaller area at the bottom, <em>Quick import</em>, uses default
import settings and is a good way to begin.</p></li>
<li><p>Drag and drop your geospatial file to the <em>Quick import</em> area. For this exercise, you can download our <a href="data/us-states-shapefile.zip">US states shapefiles in .zip format</a>, which is a compressed archive that contains four shapefiles.</p></li>
</ol>
<p>Note: If you want to import a folder of shapefiles, you need to either select all files inside that folder
and drop them all together to the import area, or upload all of them inside a compressed <code>.zip</code> archive.</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Each imported file becomes a layer, and is accessible from the dropdown menu in the top-middle
of the browser window. There, you can see how many features each layer has, toggle their visibility,
or delete them.</p></li>
<li><p>To export, go to <em>Export</em> in the upper-right corner, and select a desired file format.
The choice of export formats is shown in Figure <a href="mapshaper.html#fig:mapshaper-export">13.8</a>.
Currently, available formats are Shapefile, GeoJSON,
TopoJSON (similar to GeoJSON, but with topographical data), JSON records, CSV,
or SVG (Scalable Vector Graphics, for web and print). If you export more than one layer at a time,
Mapshaper will archive them first, and you will download an <code>output.zip</code> that contains
all exported layers.</p></li>
</ol>

<div class="figure"><span id="fig:mapshaper-export"></span>
<img src="images/13-transform/mapshaper-export.png" alt="You can use Mapshaper to quickly convert between geospatial file formats."  />
<p class="caption">
Figure 13.8: You can use Mapshaper to quickly convert between geospatial file formats.
</p>
</div>
<p>Tip: Mapshaper doesn’t work with KML or KMZ files, but you can use <a href="geojson.html">GeoJson.io</a> to first convert them into GeoJSON format, then upload to Mapshaper.</p>
</div>
<div id="edit-data-for-specific-polygons" class="section level4 unnumbered">
<h4>Edit data for specific polygons</h4>
<p>You can edit attribute data of individual polygons (and also points and lines) in Mapshaper, as shown in Figure <a href="mapshaper.html#fig:mapshaper-edit">13.9</a>.</p>
<ol style="list-style-type: decimal">
<li><p>Import the file whose polygon attributes you want to edit.</p></li>
<li><p>Under the cursor tool, select <em>edit attributes</em>.</p></li>
<li><p>Click on the polygon you want to edit. A pop-up will appear in the upper-left corner
listing all attributes and values of the polygon.</p></li>
<li><p>Click on any value (underlined, in blue) and edit it.</p></li>
<li><p>When you are done, export your geospatial file by clicking <em>Export</em> and
choosing the desired file format.</p></li>
</ol>

<div class="figure"><span id="fig:mapshaper-edit"></span>
<img src="images/13-transform/mapshaper-edit-annotated.png" alt="Use edit attributes tool (under Cursor tool) to edit attributes of polygons, lines, and points."  />
<p class="caption">
Figure 13.9: Use <em>edit attributes</em> tool (under Cursor tool) to edit attributes of polygons, lines, and points.
</p>
</div>
</div>
<div id="rename-data-fields" class="section level4 unnumbered">
<h4>Rename data fields</h4>
<p>Mapshaper’s most powerful tools are available through the <em>Console</em> button at the top, which opens a window where you can type commands for common map editing tasks.</p>
<p>Sometimes map features (such as points, polylines, and polygons) contain <em>attributes</em> (data fields or columns) with long or confusing names. In the Mapshaper <em>Console</em>, you can easily change field names by entering the rename command in this generic format:</p>
<p><code>-rename-fields NewName=OldName</code></p>
<p>First, select the <em>inspect features</em> arrow symbol in Mapshaper and float your cursor over map features to view their field names, then click open the <em>Console</em> windows, as shown in Figure <a href="mapshaper.html#fig:mapshaper-rename">13.10</a>. In this example, to change the longer field name (<code>STATE_TITLE</code>) to a shorter one (<code>name</code>), enter this command into the console:</p>
<p><code>-rename-fields name=STATE_TITLE</code></p>

<div class="figure"><span id="fig:mapshaper-rename"></span>
<img src="images/13-transform/mapshaper-rename-annotated.png" alt="Select the inspect features arrow to view field names, and rename them using the -rename-fields command in the console."  />
<p class="caption">
Figure 13.10: Select the <em>inspect features</em> arrow to view field names, and rename them using the <code>-rename-fields</code> command in the console.
</p>
</div>
</div>
<div id="remove-unwanted-data-fields" class="section level4 unnumbered">
<h4>Remove unwanted data fields</h4>
<p>Sometimes map features contain unwanted attributes (data fields or columns) that you want to remove, which you can easily do with the <code>-filter-fields</code> command in the Mapshaper console.</p>
<p>For example, this command removes all fields except <em>town</em>:</p>
<p><code>-filter-fields town</code></p>
<p>If you want to leave more than one field, separate them by a comma, but without spaces, like this:</p>
<p><code>-filter-fields town,state</code></p>
<p>Warning: If you leave a space after a comma, you will get a <em>Command expects a single value</em> error.</p>
</div>
<div id="simplify-map-boundaries-to-reduce-file-size" class="section level4 unnumbered">
<h4>Simplify map boundaries to reduce file size</h4>
<p>When you find GeoJSON maps on the web, they may contain detailed boundaries (especially around coastlines) that increase the file size, which may slow down the performance of your online web maps. Since you do not always need highly-detailed boundaries for data visualization projects with zoomed-out geographies, consider using Mapshaper to simplify your map boundaries. The result will be less precise, but faster to load in user’s browsers.</p>
<p>To understand how to simplify map boundaries, consider two maps of the contiguous US states (also known as <em>the lower 48</em>,
the term co-author Ilya learned in 2018 while traveling in Alaska), as shown in Figure <a href="mapshaper.html#fig:mapshaper-simplify-demo">13.11</a>.
The map in Figure <a href="mapshaper.html#fig:mapshaper-simplify-demo">13.11</a>a is more detailed and is about 230 kilobytes, but the map in Figure <a href="mapshaper.html#fig:mapshaper-simplify-demo">13.11</a>b
is only 37 kilobytes, or six times smaller! However, be careful not to simplify boundaries so much that you remove important features.</p>

<div class="figure"><span id="fig:mapshaper-simplify-demo"></span>
<img src="images/13-transform/mapshaper-simplify-demo-annotated.png" alt="Consider simplifying geometries with Mapshaper to make your web maps faster."  />
<p class="caption">
Figure 13.11: Consider simplifying geometries with Mapshaper to make your web maps faster.
</p>
</div>
<p>To simplify map boundaries in Mapshaper, follow the steps below.</p>
<ol style="list-style-type: decimal">
<li><p>Import your geodata file to Mapshaper. You can use the <a href="data/lower-48.geojson">sample contiguous US states in GeoJSON format</a>.</p></li>
<li><p>Click the <em>Simplify</em> button in the upper-right corner. The Simplification menu will appear,
where you can choose one of three methods. We recommend checking <em>prevent shape removal</em>, and leaving
the default <em>Visvalingam / weighted area</em>. Click <em>Apply</em>.</p></li>
<li><p>You will see a slider with <code>100%</code> appear on top (Figure <a href="mapshaper.html#fig:mapshaper-simplify">13.12</a>), replacing the layer selection dropdown.
Move the slider to the right and see the map simplify its shape as you go. Stop when you think
the map looks appropriate (when the shapes are still recognizable).</p></li>
<li><p>Mapshaper may suggest to repair line intersections in the upper-left corner. Click <em>Repair</em>.</p></li>
<li><p>You can now export your file using the <em>Export</em> feature.</p></li>
</ol>

<div class="figure"><span id="fig:mapshaper-simplify"></span>
<img src="images/13-transform/mapshaper-simplify.png" alt="Use Simplify &amp; Repair tools in Mapshaper."  />
<p class="caption">
Figure 13.12: Use Simplify &amp; Repair tools in Mapshaper.
</p>
</div>
<p>Tip: Tip: When you upload a geographic file to Mapshaper, you may need to change its projection to align with your visualization tools or related geodata. Click to open the <em>Console</em> and type <code>-proj webmercator</code> (or <code>-proj EPSG:3857</code>) to change the projection to Web Mercator, the format commonly used by Google Maps and other web mapping tools.</p>
</div>
<div id="dissolve-internal-polygons-to-create-an-outline-map" class="section level4 unnumbered">
<h4>Dissolve internal polygons to create an outline map</h4>
<p>A common map editing task is to create an outline map by removing the internal boundaries. For example, you can dissolve
state boundaries of the US map in the previous exercise to get the outline of the country, as shown in
Figure <a href="mapshaper.html#fig:mapshaper-dissolve">13.13</a>.</p>

<div class="figure"><span id="fig:mapshaper-dissolve"></span>
<img src="images/13-transform/mapshaper-dissolve.png" alt="Mapshaper lets you dissolve boundaries to create an outline shape."  />
<p class="caption">
Figure 13.13: Mapshaper lets you dissolve boundaries to create an outline shape.
</p>
</div>
<p>Click on <em>Console</em>, which opens a window to type in commands. Enter the <em>dissolve</em> command exactly as shown below, then press the <em>Return</em> or <em>Enter</em> key.</p>
<p><code>-dissolve</code></p>
<p>You will see that internal boundaries became lighter color, and that’s Mapshaper’s way of saying they no longer exist.
You can now export your outline shape.</p>
</div>
<div id="clip-a-map-to-match-an-outline-layer" class="section level4 unnumbered">
<h4>Clip a map to match an outline layer</h4>
<p>Another common map editing task is to “clip” out a smaller portion of a larger map to obtain only the area you need. For example, the State of Connecticut consists of 8 counties, which in turn are divided into a total of 169 towns.
Imagine you are given a <a href="data/ct-towns.geojson">boundary file of all 169 towns</a>, and <a href="data/hartfordcounty-outline.geojson">the outline of Hartford county</a>.
You need to “clip” the original towns map to only include those towns that fall within a specific portion of Connecticut: Hartford County.</p>
<p>Mapshaper allows you to do just that using one simple <code>-clip</code> command.</p>
<ol style="list-style-type: decimal">
<li><p>Import two boundary files into Mapshaper. One is the larger one that is being clipped (if you use sample files, <em>ct-towns</em>),
and one is the desired final shape (<em>hartfordcounty-outline</em>). The latter is what ArcGIS calls the “clip feature.”</p></li>
<li><p>Make sure your active layer is set to the map you are clipping (<em>ct-towns</em>).</p></li>
<li><p>In the <em>Console</em>, type <code>-clip</code> followed by the name of your clip layer, like this:</p></li>
</ol>
<p><code>-clip hartfordcounty-outline</code></p>
<ol start="4" style="list-style-type: decimal">
<li>You should see your active layer got clipped. Sometimes you end up with tiny “slivers” of clipped areas that remain alongside the borders.
If that is the case, use a related command to remove them, like this:</li>
</ol>
<p><code>-clip hartfordcounty-outline -filter-slivers</code></p>
<ol start="5" style="list-style-type: decimal">
<li>Your Mapshaper state should look like the one pictured in Figure <a href="mapshaper.html#fig:mapshaper-clip">13.14</a>. You can now save the file on your computer using the <em>Export</em> button.</li>
</ol>

<div class="figure"><span id="fig:mapshaper-clip"></span>
<img src="images/13-transform/mapshaper-clip-annotated.png" alt="When clipping, make sure your active layer is the one being clipped (with many features), not the clipping feature itself."  />
<p class="caption">
Figure 13.14: When clipping, make sure your active layer is the one being clipped (with many features), not the clipping feature itself.
</p>
</div>
</div>
<div id="join-spreadsheet-data-with-polygon-map" class="section level4 unnumbered">
<h4>Join spreadsheet data with polygon map</h4>
<p>Combining spreadsheet data with geographical boundaries is a common task in data visualization. In this exercise, you will download this <a href="data/ct-towns.geojson">Connecticut town boundaries map in GeoJson format</a>,
and also download this <a href="data/ct-towns-popdensity.csv">Connecticut town population data in CSV format</a>, and join the two of them in order to build a choropleth map.</p>
<p>Mapshaper provides a powerful <code>-join</code> command to connect these files files. Remember that you need some common keys
in both datasets (such as <em>town name</em>, or <em>state</em>, or <em>country</em>) in order to join the two files. Without a common field, Mapshaper has no way of knowing which
numbers belong to which polygons.</p>
<ol style="list-style-type: decimal">
<li><p>Import both the GeoJSON file and the CSV file you downloaded above into Mapshaper using its Quick import box.</p></li>
<li><p>Make sure both files appear in the drop-down list of layers.
Your CSV data will appear to resemble a table. Use the <em>Cursor &gt; inspect features</em> tool
to make sure the data is imported correctly. If you use the sample Connecticut data, note that the <em>ct-towns</em> layer
has <em>name</em> attribute with the name of the town, and <em>ct-towns-popdensity</em> has town names in the <em>town</em> column.</p></li>
<li><p>Make your geospatial layer (<em>ct-towns</em>) the active layer.</p></li>
<li><p>Open the <em>Console</em> and enter the <code>-join</code> command, like this:</p></li>
</ol>
<p><code>-join ct-towns-popdensity keys=name,town</code></p>
<p>In this command, <code>ct-towns-popdensity</code> is the CSV layer you are merging with, and <code>keys</code> are the attributes that contain values to join by.
For our sample data, these would be town names which are stored in <code>name</code> attribute of the map file, and <code>town</code> column
of the CSV file.</p>
<ol start="5" style="list-style-type: decimal">
<li><p>You will see a message in the console notifying you if join was performed successfully, or if Mapshaper encountered any errors.</p></li>
<li><p>Use the <em>Cursor &gt; inspect features</em> tool to make sure you see CSV columns as fields of your polygons, as shown in Figure <a href="mapshaper.html#fig:mapshaper-join">13.15</a>.</p></li>
<li><p>You can now save the file to your computer by clicking the <em>Export</em> button.</p></li>
</ol>

<div class="figure"><span id="fig:mapshaper-join"></span>
<img src="images/13-transform/mapshaper-join-annotated.png" alt="In Mapshaper, join spatial and CSV files using common keys, such as town names."  />
<p class="caption">
Figure 13.15: In Mapshaper, join spatial and CSV files using common keys, such as town names.
</p>
</div>
<p>Tip: To avoid confusion, consider using the <code>-rename-fields</code> command on your CSV data that contains key values, in order to match the key attribute name of your map.
In our example, first you would <code>-rename-fields name=town</code> to your CSV file. Renaming this CSV field to <code>name</code> avoids confusion in the second step, because your join command would end with <code>keys=name,name</code>.</p>
</div>
<div id="count-points-in-polygons-with-mapshaper" class="section level4 unnumbered">
<h4>Count points in polygons with Mapshaper</h4>
<p>Mapshaper lets you count points in polygons, and record that number in polygon attributes using <code>-join</code> command.</p>
<ol style="list-style-type: decimal">
<li><p>Download two sample GeoJSON files to your computer: the points that you want to aggregate, such as <a href="data/hospitals-points.geojson">hospital points in the US</a>, and polygon boundaries, such as <a href="data/us-states.geojson">US state boundaries</a>. Import both into Mapshaper.</p></li>
<li><p>Make sure you choose “polygons” (not points) for the active layer by selecting it from the dropdown menu.</p></li>
<li><p>In the <em>Console</em>, do a <code>-join</code> command using a <code>count()</code> function, like this:</p></li>
</ol>
<p><code>-join hospitals-points calc='hospitals = count()' fields=</code></p>
<p>This command tells Mapshaper to count points inside the <em>hospitals-points</em> layer and record them as the <em>hospitals</em> attribute of the polygons.
The <code>fields=</code> part tells Mapshaper to not copy any fields from the points, because in our case we are performing many-to-one matching, meaning many hospitals per state.</p>
<ol start="4" style="list-style-type: decimal">
<li><p>Use the <em>Cursor &gt; inspect features</em> tool to make sure polygons obtained a new field with the recorded count of points,
as shown in Figure <a href="mapshaper.html#fig:mapshaper-count-points">13.16</a>.</p></li>
<li><p>Save the new file using the <em>Export</em> button and chose the desired output format. In the section below,
we will talk about what happens to objects that don’t join.</p></li>
</ol>

<div class="figure"><span id="fig:mapshaper-count-points"></span>
<img src="images/13-transform/mapshaper-count-points.png" alt="Mapshaper’s -join command can count points in polygons."  />
<p class="caption">
Figure 13.16: Mapshaper’s <em>-join</em> command can count points in polygons.
</p>
</div>
</div>
<div id="more-about-joins" class="section level4 unnumbered">
<h4>More about joins</h4>
<p>In the section above on “Count points in polygons,” you did not need to specify <em>keys</em> to join locations between two geographical layers: points and polygons. But if one of the files you wish to join is a CSV dataset, you need <em>keys</em>.</p>
<p>If you don’t have a CSV dataset that matches the columns in your boundary map data, you can easily create one.
Upload the boundary map to Mapshaper, and export in CSV format. Open the downloaded CSV file in any spreadsheet tool.
To match data columns in the CSV spreadsheet, use the <a href="vlookup.html">VLOOKUP</a> function.</p>
<p>In real life, you will rarely have perfect files with one-to-one matches,
so you might want to have more information about which features didn’t get matched so
that you can fix your data.
Mapshaper helps you keep track of data that is not properly joined or matched. For example, if the polygon map contains 169 features
(one for each town in Connecticut), but the CSV table contains only 168 rows of data, Mapshaper will join all of those with matching keys,
and then display this message:</p>
<pre><code>[join] Joined data from 168 source records to 168 target records
[join] 1/169 target records received no data
[join] 1/169 source records could not be joined</code></pre>
<p>To get more details on which values were not joined, add <code>unjoined unmatched -info</code> flags to your join command, like this:</p>
<p><code>-join ct-towns-popdensity keys=name,town unjoined unmatched -info</code></p>
<p>The <code>unjoined</code> flag saves a copy of each unjoined record from the source table into another layer named <em>unjoined</em>. The <code>unmatched</code> flag saves a copy of each unmatched record from the target table to a new layer named <em>unmatched</em>. Finally, the <code>-info</code> flag outputs some additional information about the joining procedure to the console.</p>
</div>
<div id="merge-selected-polygons-with-join-and-dissolve-commands" class="section level4 unnumbered">
<h4>Merge selected polygons with join and dissolve commands</h4>
<p>In Mapshaper, you can merge selected polygons into larger clusters using <code>-join</code> and <code>-dissolve</code> commands. Imagine that you are employed by the CT Department of Public Health, and your task is to divide 169 towns into 20 <a href="https://portal.ct.gov/DPH/Local-Health-Admin/LHA/Local-Health-Administration---Site-Map">public health districts</a> and produce a new geospatial file.</p>
<p>You should begin by creating a <em>crosswalk</em> of towns and their health districts, which means some way of matching two sets of data, such as zip codes and towns where they are located. In our case, the crosswalk can be as simple as a two-column CSV list
of a town and its district, each on a new line. Because your boss didn’t give you a list of towns in a spreadsheet format,
but instead a GeoJSON file with town boundaries, let’s extract a list of towns from it.</p>
<ol style="list-style-type: decimal">
<li><p>Import <a href="data/ct-towns.geojson">ct-towns.geojson</a> to Mapshaper using Quick import box.</p></li>
<li><p>Use the <em>Cursor &gt; inspect features</em> tool to see that each polygon has a <em>name</em> attribute with the name of the town.</p></li>
<li><p>Save attribute data as a CSV file using <em>Export</em> button. Open the file in any spreadsheet tool. You will see that your data is a one-column
file with a <em>name</em> column that lists 169 towns.</p></li>
<li><p>In your spreadsheet, create a second column titled <em>merged</em> and copy-paste values from the first <em>name</em> column. At this point your spreadsheet contains two columns with the same values.</p></li>
<li><p>Pick a few towns, such as <em>West Hartford</em> and <em>Bloomfield</em>, and assign “Bloomfield-West Hartford”
to their <em>merged</em> column, as shown in Figure <a href="mapshaper.html#fig:mapshaper-merge-csv">13.17</a>. You can stop here and move to the next step, or keep assigning district names to a few other neighboring towns.</p></li>
</ol>

<div class="figure"><span id="fig:mapshaper-merge-csv"></span>
<img src="images/13-transform/mapshaper-merge-csv.png" alt="Create a two-column crosswalk of town names and their merged health districts." width="350" />
<p class="caption">
Figure 13.17: Create a two-column crosswalk of town names and their merged health districts.
</p>
</div>
<ol start="6" style="list-style-type: decimal">
<li><p>Save this new spreadsheet file as <em>ct-towns-merged.csv</em>, and drag-and-drop it to Mapshaper on top of your <em>ct-towns</em> layer. Click <em>Import</em>.</p></li>
<li><p>In Mapshaper, this new CSV layer, named <em>ct-towns-merged</em>, will appear as a series of table cells. From the dropdown menu,
select <em>ct-towns</em> to get back to your map.</p></li>
<li><p>Now you are ready to merge certain towns into districts according to your uploaded CSV file. Open the <em>Console</em>, and type:</p></li>
</ol>
<p><code>-join ct-towns-merged keys=name,name</code></p>
<p>to join the CSV layer with the boundaries layer that you see on the screen.</p>
<p>Then type:</p>
<p><code>-dissolve merged</code></p>
<p>to dissolve polygons of towns according to the <em>merged</em> column of the CSV file.</p>
<p>In our example, only Bloomfield and West Hartford are dissolved into a combined
“Bloomfield-West Hartford” regional health district, with the shared boundary line between those towns becoming grayed out,
and all of the other polygons remain the same. Figure <a href="mapshaper.html#fig:mapshaper-merge">13.18</a> shows the final result.</p>

<div class="figure"><span id="fig:mapshaper-merge"></span>
<img src="images/13-transform/mapshaper-merge.png" alt="Merge polygons based on a predefined crosswalk."  />
<p class="caption">
Figure 13.18: Merge polygons based on a predefined crosswalk.
</p>
</div>
<p>You can inspect attribute data of polygons using <em>Cursor &gt; inspect features</em> tool, and save the resulting file
using the <em>Export</em> button.</p>
<p>Overall, Mapshaper is a powerful geodata editing tool with many more commands that are worth exploring. Some of these include changing projections, filtering features using JavaScript expressions, assigning colors to polygons based on values, and many more. Explore the <a href="https://github.com/mbloch/mapshaper/wiki/Command-Reference">MapShaper Wiki on GitHub</a> to learn more commands and see more examples.</p>
</div>
</div>
<footer style="margin-top: 60px; font-size: 0.8em; padding: 10px; background-color: rgba(0,0,0,0.08); display: table; width: 98%">

  <a href="https://www.amazon.com/Hands-Data-Visualization-Storytelling-Spreadsheets/dp/1492086002/" style="width: 80px; margin-left: auto; margin-right: auto;"  class="db dtc-ns">
    <img src="images/0-preface/cover-400wide.jpg" alt="O'Reilly Book Cover" style="width: 100px;" />
  </a>

  <div style="padding: 0 15px;" class="db dtc-ns">
    <p>
      Buy the print book at
      <a href="https://www.amazon.com/Hands-Data-Visualization-Storytelling-Spreadsheets/dp/1492086002/">Amazon</a> -
      <a href="https://www.barnesandnoble.com/w/hands-on-data-visualization-jack-dougherty/1137725933">Barnes & Noble</a> -
      <a href="https://bookshop.org/books/hands-on-data-visualization-interactive-storytelling-from-spreadsheets-to-code/9781492086000">Bookshop</a> -
      <a href="https://www.powells.com/book/hands-on-data-visualization-9781492086000">Powell's</a> - or your local bookstore.<br>
      Or begin a 30-day free trial to all books and digital content on the <a href="https://learning.oreilly.com/get-learning/?code=HODV21">O'Reilly online learning platform</a>.<br>
      Share your feedback about the book by tagging <a href="https://twitter.com/handsondataviz" target="_blank">@handsondataviz on Twitter</a> or
      <a href="https://handsondataviz.org/authors.html">contact the authors</a>.
    </p>

    <p style="color: rgba(0,0,0,0.4)">
      &copy; 2021 Jack Dougherty & Ilya Ilyankou / Picturedigits Ltd.
    </p>
  </div>
</footer>

<style>
  footer a:hover img {
    transform: rotate(1deg);
  }

  .db {
    display: block;
  }

  @media screen and (min-width: 30em) {
    .dtc-ns {
      display: table-cell;
      vertical-align: middle;
    }
}
</style>
            </section>

          </div>
        </div>
      </div>
<a href="geojsonio.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="convert-kmz.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/handsondataviz/book/blob/main/13-transform.Rmd",
"text": null
},
"download": ["HandsOnDataViz.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

</body>

</html>
